{% extends 'base.html' %} 
</head>
{% block content %}
<script src="http://code.jquery.com/jquery-1.8.3.js"></script>
{% load static %}
<script src="{% static 'js/script.js' %}"></script>
<script type="text/javascript">

$(document).ready(function() {
	  $('.design').each(function() {
	    var design = $(this).attr('data-design');
	    var id = $(this).attr('id');
	    var canvas = $(this).find("canvas")[0];
	    var ctx = canvas.getContext("2d");
	    var img = new Image;
	    img.onload = function() {
	      canvas.width  = this.width;
	      canvas.height = this.height;
	      ctx.drawImage(this, 0, 0);
	      ctx.strokeStyle = '#FF0000';
	  	  ctx.fillStyle = '#FF0000';    
	    };
	    img.src = design;
	  });
	});
</script>
	<div class="main-grid">
		<div class="agile-grids">
			<!-- validation -->
			<div class="grids">
				<div class="progressbar-heading grids-heading">
					<h2>Pitch and Slope Calculator</h2>
					{% if request.session.loggedIn == 'Yes' %}
                			<a style="font-size:14px;font-weight:bold;color:blue;float:right;" href="{% url 'viewImage' %}">Welcome {{ request.session.userName }}</a>
        			{% endif %}
				</div>

				<div class="forms-grids">
					<div class="forms3">
						<div class="w3agile-validation w3ls-validation">
							<div class="panel panel-widget agile-validation register-form">
								<div class="validation-grids widget-shadow"
									data-example-id="basic-forms">
									<div class="input-info">
										<h3>Uploaded Image</h3>
									</div>
									<div class="form-body form-body-info">
										<form data-toggle="validator"  name="processImage" onsubmit="return checkForLogin()"
											action="{% url 'processImage' %}" method="post"
											enctype="multipart/form-data">
											{% if request.session.uploadedFile %}
												<input type="hidden" name="uploadedUrl" id="id_uploadedFile" value="{{ request.session.uploadedFile }}">
											{% endif %}
											<input type="hidden" id="imageString" name="imageString" value=""/>
											{% csrf_token %} 
											{% if request.session.loggedIn %} 
											<input type="hidden" name="loggedIn" id="id_loggedIn" value="{{ request.session.loggedIn }}">
											{% else %}	
												<input type="hidden" name="loggedIn" id="id_loggedIn" value="No">
											{% endif %}
											<center>
												<div class="form-group design" id="image" data-design="{{ request.session.uploadedFile }}">
												  <canvas id="paint" width="800px" height="800px" style="border: 5px solid #000000;"></canvas>
												</div>
											<!-- <div class="form-group valid-form">
												{% if request.session.uploadedFile %} <img 
													src="{{ request.session.uploadedFile }}" alt="{{ request.session.uploadedFile }}"></img>
												{% endif %}
											</div> -->
												<div class="form-group" style="font-size:16;color:white;">
													<p>
														<a href="{% url 'userHome' %}">Return to home</a>
														{% if not request.session.loggedIn %}
															<a href="{% url 'signup' %}">SignUp|Login</a>
														{% endif %}
														{% if request.session.loggedIn == "No" %}
															<a href="{% url 'signup' %}">SignUp|Login</a>
														{% endif %}
													</p>
												</div>
												<div class="form-group">
													<button type="submit" class="btn btn-primary">Calculate</button>
												<!-- <table>
													<tr>
														<td style="padding-right:20px;"><button type="submit" class="btn btn-primary">Calculate</button></td>
														<td><button type="button" class="btn btn-primary" id="saveImage" onclick="javascript:saveImageToServer()">Save</button></td>
													</tr>
												</table> -->
												</div>
											</center>
										</form>
									</div>
								</div>
							</div>
						</div>
						<div class="clear"></div>
					</div>
				</div>
			</div>
			<!-- //validation -->
		</div>
	</div>
	<!-- footer -->
	<!-- <div class="footer">
			<p>2018 Pitch And Slope Calculator. All Rights Reserved .</p>
		</div> -->
	<!-- //footer -->
	<!-- input-forms -->
 <script src="http://code.jquery.com/jquery-1.8.3.js"></script>
 {% load static %}
 <script src="{% static 'js/script.js' %}"></script>
{% endblock %}
